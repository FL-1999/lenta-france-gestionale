{% extends "shared/base.html" %}

{% block title %}
    {% set lang = request.cookies.get('lang', 'it') %}
    {% if lang == 'fr' %}Nouveau v√©hicule{% else %}Nuovo veicolo{% endif %}
{% endblock %}

{% block content %}
{% set lang = request.cookies.get('lang', 'it') %}

<div class="page-header">
    <h1 class="page-title">üöê {% if lang == 'fr' %}Nouveau v√©hicule{% else %}Nuovo veicolo{% endif %}</h1>
    <p class="page-subtitle">
        {% if lang == 'fr' %}
            Ajoutez un nouveau v√©hicule aziendale √† la flotte, avec les informations principales.
        {% else %}
            Aggiungi un nuovo veicolo aziendale alla flotta, con le informazioni principali.
        {% endif %}
    </p>
</div>

<div class="card">
    <form method="post"
          action="{{ url_for('manager_veicoli_create') }}"
          class="form-grid">

        <!-- Sezione: dati principali -->
        <div class="form-section form-field--full">
            <h2 class="form-section-title">
                {% if lang == 'fr' %}Donn√©es principales{% else %}Dati principali{% endif %}
            </h2>
        </div>

        <div class="form-field">
            <label for="marca">{% if lang == 'fr' %}Marque*{% else %}Marca*{% endif %}</label>
            <input type="text"
                   id="marca"
                   name="marca"
                   placeholder="{% if lang == 'fr' %}Ex. Renault{% else %}Es. Fiat{% endif %}"
                   required />
        </div>

        <div class="form-field">
            <label for="modello">{% if lang == 'fr' %}Mod√®le*{% else %}Modello*{% endif %}</label>
            <input type="text"
                   id="modello"
                   name="modello"
                   placeholder="{% if lang == 'fr' %}Ex. Clio{% else %}Es. Ducato{% endif %}"
                   required />
        </div>

        <div class="form-field">
            <label for="targa">{% if lang == 'fr' %}Plaque*{% else %}Targa*{% endif %}</label>
            <input type="text"
                   id="targa"
                   name="targa"
                   placeholder="{% if lang == 'fr' %}Ex. AB-123-CD{% else %}Es. AB123CD{% endif %}"
                   required />
            <small class="field-help">
                {% if lang == 'fr' %}
                    La plaque sera enregistr√©e en majuscules automatiquement.
                {% else %}
                    La targa verr√† salvata automaticamente in maiuscolo.
                {% endif %}
            </small>
        </div>

        <!-- Sezione: dettagli veicolo -->
        <div class="form-section form-field--full">
            <h2 class="form-section-title">
                {% if lang == 'fr' %}D√©tails du v√©hicule{% else %}Dettagli veicolo{% endif %}
            </h2>
        </div>

        <div class="form-field">
            <label for="anno">{% if lang == 'fr' %}Ann√©e{% else %}Anno{% endif %}</label>
            <input type="number"
                   id="anno"
                   name="anno"
                   min="1990"
                   max="2100"
                   placeholder="2020" />
        </div>

        <div class="form-field">
            <label for="km">Km</label>
            <input type="number"
                   id="km"
                   name="km"
                   min="0"
                   step="1"
                   placeholder="150000" />
            <small class="field-help">
                {% if lang == 'fr' %}
                    Kilom√©trage actuel (approximatif).
                {% else %}
                    Chilometraggio attuale (anche indicativo).
                {% endif %}
            </small>
        </div>

        <div class="form-field">
            <label for="carburante">{% if lang == 'fr' %}Carburant{% else %}Carburante{% endif %}</label>
            <select id="carburante" name="carburante">
                <option value="">{% if lang == 'fr' %}S√©lectionnez{% else %}Seleziona{% endif %}</option>
                <option value="diesel">Diesel</option>
                <option value="benzina">{% if lang == 'fr' %}Essence{% else %}Benzina{% endif %}</option>
                <option value="gpl">GPL</option>
                <option value="metano">Metano</option>
                <option value="ibrido">{% if lang == 'fr' %}Hybride{% else %}Ibrido{% endif %}</option>
                <option value="elettrico">{% if lang == 'fr' %}√âlectrique{% else %}Elettrico{% endif %}</option>
            </select>
        </div>

        <!-- Sezione: scadenze -->
        <div class="form-section form-field--full">
            <h2 class="form-section-title">
                {% if lang == 'fr' %}√âch√©ances{% else %}Scadenze{% endif %}
            </h2>
        </div>

        <div class="form-field">
            <label for="assicurazione_scadenza">
                {% if lang == 'fr' %}Assurance ‚Äì √©ch√©ance{% else %}Assicurazione ‚Äì scadenza{% endif %}
            </label>
            <input type="date" id="assicurazione_scadenza" name="assicurazione_scadenza" />
        </div>

        <div class="form-field">
            <label for="revisione_scadenza">
                {% if lang == 'fr' %}R√©vision ‚Äì √©ch√©ance{% else %}Revisione ‚Äì scadenza{% endif %}
            </label>
            <input type="date" id="revisione_scadenza" name="revisione_scadenza" />
        </div>

        <!-- Sezione: assegnazione -->
        <div class="form-section form-field--full">
            <h2 class="form-section-title">
                {% if lang == 'fr' %}Affectation{% else %}Assegnazione{% endif %}
            </h2>
        </div>

        <div class="form-field form-field--full">
            <label for="assegnato_a_id">
                {% if lang == 'fr' %}V√©hicule attribu√© √†{% else %}Veicolo assegnato a{% endif %}
            </label>
            <select id="assegnato_a_id" name="assegnato_a_id">
                <option value="">
                    {% if lang == 'fr' %}Aucun / v√©hicule partag√©{% else %}Nessuno / veicolo condiviso{% endif %}
                </option>
                {% for p in personale_list %}
                    <option value="{{ p.id }}">
                        {{ p.cognome }} {{ p.nome }}
                    </option>
                {% endfor %}
            </select>
        </div>

        <!-- Note -->
        <div class="form-field form-field--full">
            <label for="note">{% if lang == 'fr' %}Notes{% else %}Note{% endif %}</label>
            <textarea id="note"
                      name="note"
                      rows="3"
                      placeholder="{% if lang == 'fr' %}Assurance, √©tat g√©n√©ral, conducteur habituel...{% else %}Assicurazione, stato generale, conducente abituale...{% endif %}"></textarea>
        </div>

        <div class="form-actions">
            <a href="{{ url_for('manager_veicoli_list') }}" class="btn btn-secondary">
                {% if lang == 'fr' %}Annuler{% else %}Annulla{% endif %}
            </a>
            <button type="submit" class="btn btn-primary">
                üíæ {% if lang == 'fr' %}Enregistrer{% else %}Salva{% endif %}
            </button>
        </div>
    </form>
</div>
{% endblock %}
